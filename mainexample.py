# -*- coding: utf-8 -*-
"""
Created on Thu Feb 21 14:44:36 2019

@author: HYEJEONG
"""
import hmmexample as hmmex

import sequence as seq

a = seq.protein[0]
b = seq.secStr[0]
#states = b # hidden states, secondary structure
#symbols = a # observable, amino acid sequences

states = ('h', 'e', '_')
symbols = ('A', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'Y')

start_prob = {
    'h' : 0.33,
    'e' : 0.33,
    '_' : 0.34
}
#aminoAcid = ['A', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'Y']
'''
tranMatrix = [[0.06, 0.05, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.4], 
              [0.4, 0.6, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5],
              [0.5, 0.4, 0.6, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5],
              [0.5, 0.6, 0.4, 0.6, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5],
              [0.5, 0.6, 0.5, 0.4, 0.6, 0.5, 0.5, 0.5, 0.5, 0.5],
              [0.5, 0.6, 0.5, 0.5, 0.4, 0.6, 0.5, 0.5, 0.5, 0.5],
              [0.5, 0.6, 0.5, 0.5, 0.5, 0.4, 0.6, 0.5, 0.5, 0.5],
              [0.5, 0.6, 0.5, 0.5, 0.5, 0.5, 0.4, 0.6, 0.5, 0.5],
              [0.5, 0.6, 0.5, 0.5, 0.5, 0.5, 0.5, 0.4, 0.6, 0.5],
              [0.5, 0.6, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.4, 0.6]]
'''

trans_prob = {
        'h' : { 'h' : 0.3, 'e' : 0.2, '_' : 0.5 },
        'e' : { 'h' : 0.1, 'e' : 0.3, '_' : 0.6 },
        '_' : { 'h' : 0.2, 'e' : 0.3, '_' : 0.5 }
}

emit_prob = {
    'h': { 'A' : 0.06, 'C' : 0.04, 'D' : 0.05, 'E' : 0.05, 'F' : 0.05, 'G' : 0.05, 'H' : 0.05, 'I' : 0.05, 'K' : 0.05, 'L' : 0.05, 'M' : 0.05, 'N' : 0.05, 'P' : 0.05, 'Q' : 0.05, 'R' : 0.05, 'S' : 0.05, 'T' : 0.05, 'V' : 0.05, 'W' : 0.05, 'Y' : 0.05 },
    'e': { 'A' : 0.05, 'C' : 0.06, 'D' : 0.04, 'E' : 0.05, 'F' : 0.05, 'G' : 0.05, 'H' : 0.05, 'I' : 0.05, 'K' : 0.05, 'L' : 0.05, 'M' : 0.05, 'N' : 0.05, 'P' : 0.05, 'Q' : 0.05, 'R' : 0.05, 'S' : 0.05, 'T' : 0.05, 'V' : 0.05, 'W' : 0.05, 'Y' : 0.05 },
    '_': { 'A' : 0.05, 'C' : 0.05, 'D' : 0.06, 'E' : 0.04, 'F' : 0.05, 'G' : 0.05, 'H' : 0.05, 'I' : 0.05, 'K' : 0.05, 'L' : 0.05, 'M' : 0.05, 'N' : 0.05, 'P' : 0.05, 'Q' : 0.05, 'R' : 0.05, 'S' : 0.05, 'T' : 0.05, 'V' : 0.05, 'W' : 0.05, 'Y' : 0.05 }
}

sequence = a
model = hmmex.Model(states, symbols, start_prob, trans_prob, emit_prob)

print(model.evaluate(sequence))
print(model.decode(sequence))